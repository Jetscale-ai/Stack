name: "Ops: Verify Live"

on:
  workflow_call:
    inputs:
      public_host:
        description: "Public hostname to verify (e.g. console.jetscale.ai, demo.jetscale.ai)."
        required: false
        type: string
        default: "console.jetscale.ai"

jobs:
  smoke-test:
    name: "Ops: Smoke Test"
    runs-on: ubuntu-latest
    # âœ… FIX: Run inside the standard Booster container (has Mage + Go pre-installed)
    container:
      image: ghcr.io/jetscale-ai/booster-dev:latest
      options: --user root

    steps:
      - uses: actions/checkout@v4

      - name: Trust Git Directory
        run: git config --global --add safe.directory '*'

      - name: Run Smoke Tests
        env:
          E2E_PUBLIC_HOST: ${{ inputs.public_host }}
          E2E_ADMIN_EMAIL: ${{ secrets.JETSCALE_DEFAULT_ADMIN_EMAIL }}
          E2E_ADMIN_PASSWORD: ${{ secrets.JETSCALE_DEFAULT_ADMIN_PASSWORD }}
        run: mage test:live
