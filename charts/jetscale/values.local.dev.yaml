global:
  env: "local-dev"

# Local Dev inner-loop (Tilt):
# - Build images locally (Tilt `docker_build`)
# - live_update on source changes
# - No GHCR pulls required

# 1. DATABASE
postgres:
  enabled: true
  image: "postgres:15-alpine"
  auth:
    username: "jetscale-user"
    password: "jetscale-password"
    database: "jetscale"
  persistence:
    size: 1Gi

# 2. REDIS
redis:
  enabled: true
  image: "redis:7-bullseye"

externalSecret:
  app:
    enabled: false

# 3. BACKEND API (Dev Image + Hot Reload)
backend-api:
  serviceAccount:
    create: true
    name: "jetscale-service-account"
  image:
    repository: ghcr.io/jetscale-ai/backend-dev
    tag: "tilt"
    pullPolicy: Always
  imagePullSecrets: []
  service:
    type: NodePort
    port: 8000
    nodePort: 30000
  command: ["python3", "-m", "uvicorn", "main:app", "--host", "0.0.0.0", "--port", "8000", "--reload"]
  env:
    JETSCALE_APP_NAME: "JetScale Backend (Tilt)"
    JETSCALE_DEBUG: "true"
    JETSCALE_DB_NAME: "jetscale"
    JETSCALE_DB_USER: "jetscale-user"
    JETSCALE_DB_PASSWORD: "jetscale-password"
    JETSCALE_DATABASE_URL: "postgresql+asyncpg://jetscale-user:jetscale-password@jetscale-stack-local-postgres:5432/jetscale"
    JETSCALE_REDIS_URL: "redis://jetscale-stack-local-redis-master:6379/0"
    JETSCALE_AWS_REGION: "us-east-1"
    PYTHONDONTWRITEBYTECODE: "1"
    PYTHONUNBUFFERED: "1"
  # Background Jobs Configuration
  cronJobs: {}

# 4. BACKEND WS (Dev Image + Hot Reload)
backend-ws:
  serviceAccount:
    create: false
    name: "jetscale-service-account"
  image:
    repository: ghcr.io/jetscale-ai/backend-dev
    tag: "tilt"
    pullPolicy: Always
  imagePullSecrets: []
  service:
    type: NodePort
    port: 8001
    nodePort: 30001
  # command: ["python3", "-m", "uvicorn", "main:app", "--host", "0.0.0.0", "--port", "8000", "--reload"]
  env:
    JETSCALE_APP_NAME: "JetScale Backend (Tilt)"
    JETSCALE_DEBUG: "true"
    JETSCALE_DB_NAME: "jetscale"
    JETSCALE_DB_USER: "jetscale-user"
    JETSCALE_DB_PASSWORD: "jetscale-password"
    JETSCALE_DATABASE_URL: "postgresql+asyncpg://jetscale-user:jetscale-password@jetscale-stack-local-postgres:5432/jetscale"
    JETSCALE_REDIS_URL: "redis://jetscale-stack-local-redis-master:6379/0"
    JETSCALE_AWS_REGION: "us-east-1"
    PYTHONDONTWRITEBYTECODE: "1"
    PYTHONUNBUFFERED: "1"

# 5. FRONTEND WEB (Dev Image)
frontend:
  image:
    repository: ghcr.io/jetscale-ai/frontend-dev
    tag: "tilt"
    pullPolicy: Always
  imagePullSecrets: []
  service:
    type: NodePort
    port: 80
    nodePort: 30002
  env:
    VITE_API_BASE_URL: "http://localhost:8000"

ingress:
  enabled: false

appConfigMap:
  enabled: false